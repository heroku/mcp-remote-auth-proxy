#!/bin/sh
# Usage: bin/compile <build-dir> <cache-dir> <env-dir>

BUILD_DIR="$1"
INSTALL_DIR="$BUILD_DIR/mcp-auth-proxy"

if which node
then
  echo "MCP Auth Proxy found node $(node -v)"
else
  echo "MCP Auth Proxy requires 'node' must be available in PATH"
  exit 1
fi

set -e

mkdir -p "$INSTALL_DIR"
cp -r lib *.js *.json "$INSTALL_DIR"

cd "$INSTALL_DIR"
npm install --omit dev

echo "MCP Auth Proxy installed."
